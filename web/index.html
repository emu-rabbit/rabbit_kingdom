<!DOCTYPE html>
<html>
<head>
  <title>兔兔王國</title>
  <base href="$FLUTTER_BASE_HREF">
  <meta charset="UTF-8">
  <meta content="IE=Edge" http-equiv="X-UA-Compatible">
  <meta name="description" content="Rabbits build their own kingdom">

  <!-- iOS meta tags & icons -->
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <meta name="apple-mobile-web-app-title" content="rabbit_kingdom">
  <meta name="google-signin-client_id" content="689030757641-aeb04uu2cm5cik7t8tgpumk0kqm7006h.apps.googleusercontent.com" />
  <link rel="apple-touch-icon" href="icons/Icon-192.png">

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="favicon.png"/>
  <link rel="manifest" href="manifest.json">

  <!-- Firebase -->
  <!-- 使用 v9 的 Firebase CDN 模式（不需要 ES module） -->
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-analytics-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-messaging-compat.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyB_hUFnQ8tywSsk5bLPt1nBztyx5nX1ZyQ",
      authDomain: "rabbit-kingdom-2759a.firebaseapp.com",
      projectId: "rabbit-kingdom-2759a",
      storageBucket: "rabbit-kingdom-2759a.firebasestorage.app",
      messagingSenderId: "689030757641",
      appId: "1:689030757641:web:fe66dc39be5fb4fea4e7d8",
      measurementId: "G-6SY73Q2WEB"
    };
    firebase.initializeApp(firebaseConfig);
  </script>

  <style>
    #desktop-blocker {
      display: none;
      width: 100vw;
      height: 100vh;
      background: #111;
      color: white;
      font-size: 1.5rem;
      text-align: center;
      padding-top: 40vh;
      box-sizing: border-box;
    }
  </style>

  <script>
    function isMobileDevice() {
      return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i
        .test(navigator.userAgent);
    }

    if (!isMobileDevice()) {
      // 非手機 => 阻擋進入
      document.addEventListener("DOMContentLoaded", function () {
        document.getElementById("desktop-blocker").style.display = "block";
      });
    } else {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('firebase-messaging-sw.js')
          .then(function(registration) {
            console.log("Service Worker registered");
            // 手機 => 正常啟動 Flutter
            // window.addEventListener('DOMContentLoaded', function () {
              const script = document.createElement('script');
              script.src = "flutter_bootstrap.js";
              script.async = true;
              document.body.appendChild(script);
            // });
          }).catch(function(err) {
            console.error("Service Worker registration failed", err);
          });
     }
    }
  </script>

</head>
<body>
<div id="desktop-blocker">
  本網站目前僅支援手機裝置，請使用手機瀏覽器打開兔兔王國唷！🐰
</div>
</body>
</html>
